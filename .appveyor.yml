environment:
  matrix:
  - APPVEYOR_BUILD_WORKER_IMAGE: Visual Studio 2017
    PSEdition: Core
  - APPVEYOR_BUILD_WORKER_IMAGE: Visual Studio 2017
    PSEdition: Desktop

build: off

test_script:
- ps: |
    if ( $env:PSEdition -eq 'Desktop' ) {
    Set-StrictMode -Version Latest
    Import-Module ./Pester.psd1
    Invoke-Pester -ExcludeTag VersionChecks, StyleRules, Help -EnableExit -OutputFile TestResults.xml -OutputFormat NUnitXml
    (New-Object 'System.Net.WebClient').UploadFile("https://ci.appveyor.com/api/testresults/nunit/${env:APPVEYOR_JOB_ID}", (Join-Path $PWD 'TestResults.xml')) }
- pwsh: |
    if ( $env:PSEdition -eq 'Core' ) {
    Set-StrictMode -Version Latest
    Import-Module ./Pester.psd1
    Invoke-Pester -ExcludeTag VersionChecks, StyleRules, Help -EnableExit -OutputFile TestResults.xml -OutputFormat NUnitXml
    (New-Object 'System.Net.WebClient').UploadFile("https://ci.appveyor.com/api/testresults/nunit/${env:APPVEYOR_JOB_ID}", (Join-Path $PWD 'TestResults.xml')) }